@if (customer(); as c) {
  <div class="container">
    <mat-card>
      <mat-card-header>
        <mat-icon mat-card-avatar>person</mat-icon>
        <mat-card-title>{{ c.fullname }}</mat-card-title>
        <mat-card-subtitle>{{ c.phoneNumber }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <h3>Historial de Órdenes</h3>
        @if (c.orders.length > 0) {
          <mat-accordion>
            @for (order of c.orders; track order.id) {
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    Orden #{{ order.id }}
                  </mat-panel-title>
                  <mat-panel-description>
                    {{ order.saleDate | date:'medium' }}
                  </mat-panel-description>
                </mat-expansion-panel-header>

                <mat-list>
                  @for (item of order.orderItems; track item.id) {
                    <mat-list-item>
                      <span matListItemTitle>{{ item.product.name }}</span>
                      <span matListItemLine>Cantidad: {{ item.amount }}</span>
                    </mat-list-item>
                  }
                </mat-list>
                
                <mat-action-row>
                  <button mat-button color="primary" [routerLink]="['/orders', order.id]">Ver Orden</button>
                </mat-action-row>
              </mat-expansion-panel>
            }
          </mat-accordion>
        } @else {
          <p>Este cliente no tiene órdenes registradas.</p>
        }
      </mat-card-content>
      <mat-card-actions>
        <button mat-button routerLink="/customers">Volver a la lista</button>
      </mat-card-actions>
    </mat-card>
  </div>
}